<!-- fragments/navbar.html -->
<nav th:fragment="navbar" class="topbar">
    <!-- Left side: Brand + Links -->
    <div class="nav-left">
        <a class="navbar-brand" th:href="@{/}">
            <img th:src="@{/images/logo-Photoroom.png}" height="30" alt="RentCar">
            RentCar
        </a>

        <a th:href="@{/}">Home</a>
        <a th:href="@{/cars}">Cars</a>

        <!-- Admin: Dashboard link on left -->
        <span sec:authorize="true">
            <a th:href="@{/admin/dashboard}">Dashboard</a>
        </span>
    </div>

    <!-- Right side: User info + Auth + Dark mode -->
    <div class="nav-right">
        <!-- Not authenticated -->
        <span sec:authorize="!isAuthenticated()">
            <a th:href="@{/auth/login}">Login</a>
            <a th:href="@{/auth/register}">Register</a>
        </span>

        <!-- Regular user: Profile + Logout + Roles -->
        <span sec:authorize="isAuthenticated() and !hasAuthority('ADMIN')">
            <a th:href="@{/profile}">Profile</a>
            |
            Hello, <strong th:text="${#authentication.name}">User</strong>
            (<span th:each="role, iterStat : ${#authentication.authorities}">
                <span th:text="${role.authority.replace('ROLE_', '')}"></span>
                <span th:if="${!iterStat.last}">, </span>
            </span>)
            |
            <form th:action="@{/logout}" method="post">
                <button type="submit" class="logout-btn">Logout</button>
            </form>
        </span>

        <!-- Admin: Logout + Roles -->
        <span sec:authorize="hasAuthority('ADMIN')">
            Hello, <strong th:text="${#authentication.name}">Admin</strong>
            (<span th:each="role, iterStat : ${#authentication.authorities}">
                <span th:text="${role.authority.replace('ROLE_', '')}"></span>
                <span th:if="${!iterStat.last}">, </span>
            </span>)
            |
            <form th:action="@{/logout}" method="post">
                <button type="submit" class="logout-btn">Logout</button>
            </form>
        </span>

        <!-- Dark mode toggle -->
        <button class="theme-toggle" onclick="toggleTheme()">ðŸŒ™</button>
    </div>
</nav>
